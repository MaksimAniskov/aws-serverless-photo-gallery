(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{168:function(e,n,t){e.exports=t(396)},173:function(e,n,t){},387:function(e,n,t){},396:function(e,n,t){"use strict";t.r(n);var r,a=t(0),o=t.n(a),i=t(79),c=t.n(i),s=(t(173),t(19)),u=t.n(s),l=t(33),d=t(18),m=t(30),h=t.n(m),f=t(31),p=t(43),g=(t(385),t(164)),w=t(32),b=t(166),v="query GetSignedCookies {\n  getSignedCookies {\n    name\n    value\n  }\n}\n",x=(t(387),t(81)),E=t.n(x),k=t(160),y=t.n(k),O=t(27);!function(e){e.loading="loading",e.loaded="loaded",e.error="error",e.clearError="clearError",e.folderName="folderName",e.subfolders="subfolders",e.addImages="addImages",e.nextToken="nextToken"}(r||(r={}));var I=function(e,n){switch(n.type){case r.folderName:return Object(O.a)({},e,{folderName:n.folderName,nextToken:void 0,subfolders:[],images:[],hasMoreImages:!1});case r.loading:return Object(O.a)({},e,{isLoading:!0});case r.loaded:return Object(O.a)({},e,{isLoading:!1});case r.error:return Object(O.a)({},e,{error:n.error});case r.clearError:return Object(O.a)({},e,{error:void 0});case r.subfolders:return Object(O.a)({},e,{subfolders:n.subfolders});case r.addImages:return Object(O.a)({},e,{images:e.images.concat(n.images)});case r.nextToken:return Object(O.a)({},e,{nextToken:n.nextToken,hasMoreImages:!!n.nextToken});default:return e}},S=o.a.createContext(null),T=function(e){return o.a.createElement(S.Provider,{value:o.a.useReducer(I,{subfolders:[],images:[],isLoading:!1,hasMoreImages:!1})},e.children)},j=function(){return o.a.useContext(S)},N=function(){var e=Object(l.a)(u.a.mark(function e(n,t){var a,o,i;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=Object(d.a)(n,2),o=a[0],i=a[1],t!==o.folderName){e.next=3;break}return e.abrupt("return");case 3:return i({type:r.folderName,folderName:t}),e.next=6,L(n,t.slice(1),P);case 6:case"end":return e.stop()}},e)}));return function(n,t){return e.apply(this,arguments)}}(),C=function(){var e=Object(l.a)(u.a.mark(function e(n){var t,r;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=Object(d.a)(n,1),!(r=t[0]).isLoading){e.next=3;break}return e.abrupt("return");case 3:if(r.folderName){e.next=6;break}return console.error("Call useFetchSubfoldersAndSomeImages before calling useFetchMoreImages"),e.abrupt("return");case 6:return e.next=8,L(n,r.folderName.slice(1),"query ListImages($path: String, $limit: Int, $nextToken: String) {\n  listImages(path: $path, limit: $limit, nextToken: $nextToken) {\n    items {\n      url\n    }\n    nextToken\n  }\n}\n");case 8:case"end":return e.stop()}},e)}));return function(n){return e.apply(this,arguments)}}();function L(e,n,t){return M.apply(this,arguments)}function M(){return(M=Object(l.a)(u.a.mark(function e(n,t,a){var o,i,c,s,l,h,f;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o=Object(d.a)(n,2),i=o[0],(c=o[1])({type:r.loading}),c({type:r.clearError}),e.prev=3,s={path:t,nextToken:i.nextToken},e.next=7,m.API.graphql(Object(m.graphqlOperation)(a,s));case 7:l=e.sent,(h=l.data.listSubfolders)&&c({type:r.subfolders,subfolders:h.filter(function(e){return""!==e})}),(f=l.data.listImages)&&(f.items&&c({type:r.addImages,images:f.items.filter(function(e){return!!e}).map(function(e){return e.url})}),c({type:r.nextToken,nextToken:f.nextToken?f.nextToken:void 0})),e.next=18;break;case 14:e.prev=14,e.t0=e.catch(3),console.error(e.t0),c({type:r.error,error:"Oops... Something went wrong."});case 18:return e.prev=18,c({type:r.loaded}),e.finish(18);case 21:case"end":return e.stop()}},e,null,[[3,14,18,21]])}))).apply(this,arguments)}var P="query ListSubfoldersAndImages($path: String) {\n    listSubfolders(path: $path),\n    listImages(path: $path) {\n        items {\n          url\n        }\n        nextToken\n    }\n  }",A=function(e){return o.a.createElement("div",{className:"note"},e.caption)},$=t(167);function U(e){return btoa(Object($.a)(e).map(function(e,n){var t=e.charCodeAt(0);return t<=127?e:"\\u"+t.toString(16).padStart(4,"0")}).join(""))}var q=function(e){var n,t=j(),r=Object(d.a)(t,1)[0],a=r.isLoading,i=r.images,c=r.hasMoreImages,s=o.a.useState({width:0,height:0}),u=Object(d.a)(s,2),l=u[0],m=u[1];function h(){m({width:window.innerWidth,height:window.innerHeight})}return o.a.useEffect(function(){return window.addEventListener("resize",h),h(),N(t,e.path),function(){window.removeEventListener("resize",h)}},[t,e.path]),o.a.createElement(y.a,{onSwipeMove:function(e){n=e},onSwipeEnd:function(){return n.x<0?g():p()}},o.a.createElement(E.a,{handleKeys:["right","down","pagedown","space","enter"],onKeyEvent:function(e,n){return g(n)}}),o.a.createElement(E.a,{handleKeys:["left","up","pageup"],onKeyEvent:function(e,n){return p(n)}}),a?o.a.createElement(A,{caption:"Loading..."}):i.length?e.index>=i.length?o.a.createElement(A,{caption:"The end"}):o.a.createElement("div",null,o.a.createElement("img",{src:f(i[e.index]),className:"center",alt:i[e.index]}),e.index+1<i.length&&o.a.createElement("img",{width:"0",height:"0",src:f(i[e.index+1]),alt:""}),e.index>0&&o.a.createElement("img",{width:"0",height:"0",src:f(i[e.index-1]),alt:""})):(e.onNoPhotos&&e.onNoPhotos(),o.a.createElement(A,{caption:"No photos"})));function f(e){var n=function(){return{width:e(l.width),height:e(l.height)};function e(e){return Math.max(100,50*Math.floor(e/50))}}();return"/image/"+U(JSON.stringify({key:e,edits:{resize:{width:n.width,height:n.height,fit:"contain"}}}))}function p(n){n&&n.preventDefault(),e.index>0&&e.history.push(e.history.location.pathname+"?"+(e.index-1))}function g(n){n&&n.preventDefault(),e.index>=i.length||(e.index+1>=i.length&&c&&C(t),e.history.push(e.history.location.pathname+"?"+(e.index+1)))}},F=t(397),R=t(161),_=t.n(R),z=t(398),B=function(e){return o.a.createElement(z.a,{onClick:e.onClick,className:e.className},o.a.createElement(z.a.Body,null,o.a.createElement(z.a.Text,null,e.folderName)))},J=function(e){return o.a.createElement(z.a,{bg:"secondary",onClick:e.onClick},o.a.createElement(z.a.Img,{src:"/image/"+U(JSON.stringify({key:e.url,edits:{resize:{width:240,height:240}}})),variant:"top"}))},K=function(e){var n=j();Object(a.useEffect)(function(){N(n,e.path)});var t=Object(d.a)(n,1)[0],r=t.subfolders,i=t.isLoading,c=t.images,s=t.hasMoreImages,u=r;return"/"!==e.path&&(u=[W].concat(r)),i&&!s?o.a.createElement(A,{caption:"Loading..."}):o.a.createElement(_.a,{className:"folder-browser",initialLoad:!1,loadMore:function(){return C(n)},hasMore:s,loader:o.a.createElement(A,{key:0,caption:"Loading..."})},o.a.createElement(F.a,{className:"folders"},u.map(function(n){return o.a.createElement(B,{className:n===W?"level-up":void 0,key:n,folderName:n,onClick:function(){return e&&e.onChangeFolderIntent&&e.onChangeFolderIntent(n)}})})),o.a.createElement(F.a,{className:"images"},c.map(function(n,t){return o.a.createElement(J,{key:n,url:n,onClick:function(){return e.onSwitchToViewingIntent(t)}})})))},W="\u21d6";h.a.configure(window.AWS_EXPORTS);var H=function(e){var n=Object(a.useState)(!1),t=Object(d.a)(n,2),r=t[0],i=t[1],c=j(),s=Object(d.a)(c,1)[0].error;return s?o.a.createElement(A,{caption:s}):o.a.createElement(f.Authenticator,{hide:[f.Greetings,f.ConfirmSignIn,f.SignUp,f.ConfirmSignUp,f.TOTPSetup].concat(window.AUTH_UI_OPTIONS&&window.AUTH_UI_OPTIONS.hideForgotPassword?[f.ForgotPassword]:[]),onStateChange:function(){var e=Object(l.a)(u.a.mark(function e(n){return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("signedIn"!==n){e.next=4;break}return e.next=3,b();case 3:i(!0);case 4:case"end":return e.stop()}},e)}));return function(n){return e.apply(this,arguments)}}()},r&&o.a.createElement(p.MenuProvider,{id:"menu"},o.a.createElement(g.a,null,o.a.createElement(w.a,{render:function(e){var n=e.history,t=n.location.pathname;return"?browse"===n.location.search?o.a.createElement(K,{path:decodeURIComponent(t),onChangeFolderIntent:function(e){var r;e===W?""===(r=t.slice(0,t.lastIndexOf("/")))&&(r="/"):("/"!==(r=t)&&(r+="/"),r+=encodeURIComponent(e)),n.push(r+"?browse")},onSwitchToViewingIntent:function(e){return n.push(n.location.pathname+"?"+e)}}):o.a.createElement(q,{history:n,path:decodeURIComponent(t),index:n.location.search?parseInt(n.location.search.slice(1)):0,onNoPhotos:function(){return n.push(n.location.pathname+"?browse")}})}}),o.a.createElement(w.a,{render:function(e){var n=e.history;return o.a.createElement(p.Menu,{id:"menu"},"?browse"!==n.location.search&&o.a.createElement(p.Item,{onClick:function(){return n.push(n.location.pathname+"?browse")}},"Browse"),"?browse"!==n.location.search&&o.a.createElement(p.Separator,null),o.a.createElement(p.Item,{onClick:function(){return h.a.Auth.signOut(),void i(!1)}},"Sign out"))}}))));function b(){return x.apply(this,arguments)}function x(){return(x=Object(l.a)(u.a.mark(function n(){var t,r;return u.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,m.API.graphql(Object(m.graphqlOperation)(v));case 2:t=n.sent,(r=t.data).getSignedCookies&&r.getSignedCookies.forEach(function(n){n&&e.cookies.set(n.name,n.value,{path:"/image",secure:!0})});case 5:case"end":return n.stop()}},n)}))).apply(this,arguments)}},D=Object(b.a)(function(e){return o.a.createElement(T,null,o.a.createElement(H,e))});Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(o.a.createElement(D,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},63:function(e,n){}},[[168,1,2]]]);
//# sourceMappingURL=main.d2858647.chunk.js.map