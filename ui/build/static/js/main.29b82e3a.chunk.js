(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{167:function(e,n,t){e.exports=t(395)},172:function(e,n,t){},386:function(e,n,t){},395:function(e,n,t){"use strict";t.r(n);var a,r=t(0),o=t.n(r),i=t(79),c=t.n(i),s=(t(172),t(19)),u=t.n(s),l=t(33),d=t(18),m=t(30),h=t.n(m),f=t(31),p=t(43),g=(t(384),t(164)),w=t(32),b=t(166),x="query GetSignedCookies {\n  getSignedCookies {\n    name\n    value\n  }\n}\n",v=(t(386),t(81)),E=t.n(v),k=t(160),I=t.n(k),y=t(27);!function(e){e.loading="loading",e.loaded="loaded",e.error="error",e.clearError="clearError",e.folderName="folderName",e.subfolders="subfolders",e.addImages="addImages",e.nextToken="nextToken"}(a||(a={}));var O=function(e,n){switch(n.type){case a.folderName:return Object(y.a)({},e,{folderName:n.folderName,nextToken:void 0,subfolders:[],images:[],hasMoreImages:!1});case a.loading:return Object(y.a)({},e,{isLoading:!0});case a.loaded:return Object(y.a)({},e,{isLoading:!1});case a.error:return Object(y.a)({},e,{error:n.error});case a.clearError:return Object(y.a)({},e,{error:void 0});case a.subfolders:return Object(y.a)({},e,{subfolders:n.subfolders});case a.addImages:return Object(y.a)({},e,{images:e.images.concat(n.images)});case a.nextToken:return Object(y.a)({},e,{nextToken:n.nextToken,hasMoreImages:!!n.nextToken});default:return e}},S=o.a.createContext(null),T=function(e){return o.a.createElement(S.Provider,{value:o.a.useReducer(O,{subfolders:[],images:[],isLoading:!1,hasMoreImages:!1})},e.children)},C=function(){return o.a.useContext(S)},j=function(){var e=Object(l.a)(u.a.mark(function e(n,t){var r,o,i;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=Object(d.a)(n,2),o=r[0],i=r[1],t!==o.folderName){e.next=3;break}return e.abrupt("return");case 3:return i({type:a.folderName,folderName:t}),e.next=6,L(n,t.slice(1),P);case 6:case"end":return e.stop()}},e)}));return function(n,t){return e.apply(this,arguments)}}(),N=function(){var e=Object(l.a)(u.a.mark(function e(n){var t,a;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=Object(d.a)(n,1),!(a=t[0]).isLoading){e.next=3;break}return e.abrupt("return");case 3:if(a.folderName){e.next=6;break}return console.error("Call useFetchSubfoldersAndSomeImages before calling useFetchMoreImages"),e.abrupt("return");case 6:return e.next=8,L(n,a.folderName.slice(1),"query ListImages($path: String, $limit: Int, $nextToken: String) {\n  listImages(path: $path, limit: $limit, nextToken: $nextToken) {\n    items {\n      url\n    }\n    nextToken\n  }\n}\n");case 8:case"end":return e.stop()}},e)}));return function(n){return e.apply(this,arguments)}}();function L(e,n,t){return M.apply(this,arguments)}function M(){return(M=Object(l.a)(u.a.mark(function e(n,t,r){var o,i,c,s,l,h,f;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o=Object(d.a)(n,2),i=o[0],(c=o[1])({type:a.loading}),c({type:a.clearError}),e.prev=3,s={path:t,nextToken:i.nextToken},e.next=7,m.API.graphql(Object(m.graphqlOperation)(r,s));case 7:l=e.sent,(h=l.data.listSubfolders)&&c({type:a.subfolders,subfolders:h.filter(function(e){return""!==e})}),(f=l.data.listImages)&&(f.items&&c({type:a.addImages,images:f.items.filter(function(e){return!!e}).map(function(e){return e.url})}),c({type:a.nextToken,nextToken:f.nextToken?f.nextToken:void 0})),e.next=18;break;case 14:e.prev=14,e.t0=e.catch(3),console.error(e.t0),c({type:a.error,error:"Oops... Something went wrong."});case 18:return e.prev=18,c({type:a.loaded}),e.finish(18);case 21:case"end":return e.stop()}},e,null,[[3,14,18,21]])}))).apply(this,arguments)}var P="query ListSubfoldersAndImages($path: String) {\n    listSubfolders(path: $path),\n    listImages(path: $path) {\n        items {\n          url\n        }\n        nextToken\n    }\n  }",U=function(e){return o.a.createElement("div",{className:"note"},e.caption)},$=function(e){var n,t=C(),a=Object(d.a)(t,1)[0],r=a.isLoading,i=a.images,c=a.hasMoreImages,s=o.a.useState({width:0,height:0}),u=Object(d.a)(s,2),l=u[0],m=u[1];function h(){m({width:window.innerWidth,height:window.innerHeight})}return o.a.useEffect(function(){return window.addEventListener("resize",h),h(),j(t,e.path),function(){window.removeEventListener("resize",h)}},[t,e.path]),o.a.createElement(I.a,{onSwipeMove:function(e){n=e},onSwipeEnd:function(){return n.x<0?p():f()}},o.a.createElement(E.a,{handleKeys:["right","down","pagedown","space","enter"],onKeyEvent:function(e,n){return p(n)}}),o.a.createElement(E.a,{handleKeys:["left","up","pageup"],onKeyEvent:function(e,n){return f(n)}}),function(){if(r)return o.a.createElement(U,{caption:"Loading..."});if(!i.length)return e.onNoPhotos&&e.onNoPhotos(),o.a.createElement(U,{caption:"No photos"});if(e.index>=i.length)return o.a.createElement(U,{caption:"The end"});var n=function(){return{width:e(l.width),height:e(l.height)};function e(e){return Math.max(100,50*Math.floor(e/50))}}();return o.a.createElement("div",null,o.a.createElement("img",{src:"/image/fit-in/".concat(n.width,"x").concat(n.height,"/").concat(encodeURIComponent(i[e.index])),className:"center",alt:i[e.index]}),e.index+1<i.length&&o.a.createElement("img",{width:"0",height:"0",src:"/image/fit-in/".concat(n.width,"x").concat(n.height,"/").concat(encodeURIComponent(i[e.index+1])),alt:""}),e.index>0&&o.a.createElement("img",{width:"0",height:"0",src:"/image/fit-in/".concat(n.width,"x").concat(n.height,"/").concat(encodeURIComponent(i[e.index-1])),alt:""}))}());function f(n){n&&n.preventDefault(),e.index>0&&e.history.push(e.history.location.pathname+"?"+(e.index-1))}function p(n){n&&n.preventDefault(),e.index>=i.length||(e.index+1>=i.length&&c&&N(t),e.history.push(e.history.location.pathname+"?"+(e.index+1)))}},A=t(396),R=t(161),q=t.n(R),F=t(397),_=function(e){return o.a.createElement(F.a,{onClick:e.onClick,className:e.className},o.a.createElement(F.a.Body,null,o.a.createElement(F.a.Text,null,e.folderName)))},B=function(e){return o.a.createElement(F.a,{bg:"secondary",onClick:e.onClick},o.a.createElement(F.a.Img,{src:"/image/240x240/smart/"+e.url,variant:"top"}))},K=function(e){var n=C();Object(r.useEffect)(function(){j(n,e.path)});var t=Object(d.a)(n,1)[0],a=t.subfolders,i=t.isLoading,c=t.images,s=t.hasMoreImages,u=a;return"/"!==e.path&&(u=[W].concat(a)),i&&!s?o.a.createElement(U,{caption:"Loading..."}):o.a.createElement(q.a,{className:"folder-browser",initialLoad:!1,loadMore:function(){return N(n)},hasMore:s,loader:o.a.createElement(U,{key:0,caption:"Loading..."})},o.a.createElement(A.a,{className:"folders"},u.map(function(n){return o.a.createElement(_,{className:n===W?"level-up":void 0,key:n,folderName:n,onClick:function(){return e&&e.onChangeFolderIntent&&e.onChangeFolderIntent(n)}})})),o.a.createElement(A.a,{className:"images"},c.map(function(n,t){return n=encodeURIComponent(n),o.a.createElement(B,{key:n,url:n,onClick:function(){return e.onSwitchToViewingIntent(t)}})})))},W="\u21d6";h.a.configure(window.AWS_EXPORTS);var H=function(e){var n=Object(r.useState)(!1),t=Object(d.a)(n,2),a=t[0],i=t[1],c=C(),s=Object(d.a)(c,1)[0].error;return s?o.a.createElement(U,{caption:s}):o.a.createElement(f.Authenticator,{hide:[f.Greetings,f.ConfirmSignIn,f.SignUp,f.ConfirmSignUp,f.TOTPSetup].concat(window.AUTH_UI_OPTIONS&&window.AUTH_UI_OPTIONS.hideForgotPassword?[f.ForgotPassword]:[]),onStateChange:function(){var e=Object(l.a)(u.a.mark(function e(n){return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("signedIn"!==n){e.next=4;break}return e.next=3,b();case 3:i(!0);case 4:case"end":return e.stop()}},e)}));return function(n){return e.apply(this,arguments)}}()},a&&o.a.createElement(p.MenuProvider,{id:"menu"},o.a.createElement(g.a,null,o.a.createElement(w.a,{render:function(e){var n=e.history,t=n.location.pathname;return"?browse"===n.location.search?o.a.createElement(K,{path:decodeURIComponent(t),onChangeFolderIntent:function(e){var a;e===W?""===(a=t.slice(0,t.lastIndexOf("/")))&&(a="/"):("/"!==(a=t)&&(a+="/"),a+=encodeURIComponent(e)),n.push(a+"?browse")},onSwitchToViewingIntent:function(e){return n.push(n.location.pathname+"?"+e)}}):o.a.createElement($,{history:n,path:decodeURIComponent(t),index:n.location.search?parseInt(n.location.search.slice(1)):0,onNoPhotos:function(){return n.push(n.location.pathname+"?browse")}})}}),o.a.createElement(w.a,{render:function(e){var n=e.history;return o.a.createElement(p.Menu,{id:"menu"},"?browse"!==n.location.search&&o.a.createElement(p.Item,{onClick:function(){return n.push(n.location.pathname+"?browse")}},"Browse"),"?browse"!==n.location.search&&o.a.createElement(p.Separator,null),o.a.createElement(p.Item,{onClick:function(){return h.a.Auth.signOut(),void i(!1)}},"Sign out"))}}))));function b(){return v.apply(this,arguments)}function v(){return(v=Object(l.a)(u.a.mark(function n(){var t,a;return u.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,m.API.graphql(Object(m.graphqlOperation)(x));case 2:t=n.sent,(a=t.data).getSignedCookies&&a.getSignedCookies.forEach(function(n){n&&e.cookies.set(n.name,n.value,{path:"/image",secure:!0})});case 5:case"end":return n.stop()}},n)}))).apply(this,arguments)}},z=Object(b.a)(function(e){return o.a.createElement(T,null,o.a.createElement(H,e))});Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(o.a.createElement(z,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},63:function(e,n){}},[[167,1,2]]]);
//# sourceMappingURL=main.29b82e3a.chunk.js.map