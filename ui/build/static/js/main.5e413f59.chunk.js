(window["webpackJsonpaws-serverless-photo-gallery"]=window["webpackJsonpaws-serverless-photo-gallery"]||[]).push([[0],{168:function(e,n,t){e.exports=t(395)},173:function(e,n,t){},386:function(e,n,t){},395:function(e,n,t){"use strict";t.r(n);var r,a=t(0),o=t.n(a),i=t(78),c=t.n(i),s=(t(173),t(19)),u=t.n(s),l=t(32),d=t(18),f=t(29),h=t.n(f),m=t(30),p=t(42),g=(t(384),t(164)),w=t(31),b=t(166),v="query GetSignedCookies {\n  getSignedCookies {\n    name\n    value\n  }\n}\n",E=(t(386),t(80)),y=t.n(E),x=t(159),k=t.n(x),O=t(160);function I(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function S(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?I(t,!0).forEach((function(n){Object(O.a)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):I(t).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}!function(e){e.loading="loading",e.loaded="loaded",e.error="error",e.clearError="clearError",e.folderName="folderName",e.subfolders="subfolders",e.addImages="addImages",e.nextToken="nextToken"}(r||(r={}));var j=function(e,n){switch(n.type){case r.folderName:return S({},e,{folderName:n.folderName,nextToken:void 0,subfolders:[],images:[],hasMoreImages:!1});case r.loading:return S({},e,{isLoading:!0});case r.loaded:return S({},e,{isLoading:!1});case r.error:return S({},e,{error:n.error});case r.clearError:return S({},e,{error:void 0});case r.subfolders:return S({},e,{subfolders:n.subfolders});case r.addImages:return S({},e,{images:e.images.concat(n.images)});case r.nextToken:return S({},e,{nextToken:n.nextToken,hasMoreImages:!!n.nextToken});default:return e}},T=o.a.createContext(null),N=function(e){return o.a.createElement(T.Provider,{value:o.a.useReducer(j,{subfolders:[],images:[],isLoading:!1,hasMoreImages:!1})},e.children)},C=function(){return o.a.useContext(T)},P=function(){var e=Object(l.a)(u.a.mark((function e(n,t){var a,o,i;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=Object(d.a)(n,2),o=a[0],i=a[1],t!==o.folderName){e.next=3;break}return e.abrupt("return");case 3:return i({type:r.folderName,folderName:t}),e.next=6,M(n,t.slice(1),$);case 6:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}(),L=function(){var e=Object(l.a)(u.a.mark((function e(n){var t,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=Object(d.a)(n,1),!(r=t[0]).isLoading){e.next=3;break}return e.abrupt("return");case 3:if(r.folderName){e.next=6;break}return console.error("Call useFetchSubfoldersAndSomeImages before calling useFetchMoreImages"),e.abrupt("return");case 6:return e.next=8,M(n,r.folderName.slice(1),"query ListImages($path: String, $limit: Int, $nextToken: String) {\n  listImages(path: $path, limit: $limit, nextToken: $nextToken) {\n    items {\n      url\n    }\n    nextToken\n  }\n}\n");case 8:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}();function M(e,n,t){return A.apply(this,arguments)}function A(){return(A=Object(l.a)(u.a.mark((function e(n,t,a){var o,i,c,s,l,h,m;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=Object(d.a)(n,2),i=o[0],(c=o[1])({type:r.loading}),c({type:r.clearError}),e.prev=3,s={path:t,nextToken:i.nextToken},e.next=7,f.API.graphql(Object(f.graphqlOperation)(a,s));case 7:l=e.sent,(h=l.data.listSubfolders)&&c({type:r.subfolders,subfolders:h.filter((function(e){return""!==e}))}),(m=l.data.listImages)&&(m.items&&c({type:r.addImages,images:m.items.filter((function(e){return!!e})).map((function(e){return e.url}))}),c({type:r.nextToken,nextToken:m.nextToken?m.nextToken:void 0})),e.next=18;break;case 14:e.prev=14,e.t0=e.catch(3),console.error(e.t0),c({type:r.error,error:"Oops... Something went wrong."});case 18:return e.prev=18,c({type:r.loaded}),e.finish(18);case 21:case"end":return e.stop()}}),e,null,[[3,14,18,21]])})))).apply(this,arguments)}var $="query ListSubfoldersAndImages($path: String) {\n    listSubfolders(path: $path),\n    listImages(path: $path) {\n        items {\n          url\n        }\n        nextToken\n    }\n  }",U=function(e){return o.a.createElement("div",{className:"note"},e.caption)},q=t(167);function F(e){return btoa(Object(q.a)(e).map((function(e,n){var t=e.charCodeAt(0);return t<=127?e:"\\u"+t.toString(16).padStart(4,"0")})).join(""))}var D=function(e){var n,t=C(),r=Object(d.a)(t,1)[0],a=r.isLoading,i=r.images,c=r.hasMoreImages,s=o.a.useState({width:0,height:0}),u=Object(d.a)(s,2),l=u[0],f=u[1];function h(){f({width:window.innerWidth,height:window.innerHeight})}return o.a.useEffect((function(){return window.addEventListener("resize",h),h(),P(t,e.path),function(){window.removeEventListener("resize",h)}}),[t,e.path]),o.a.createElement(k.a,{onSwipeMove:function(e){n=e},onSwipeEnd:function(){return n.x<0?g():p()}},o.a.createElement(y.a,{handleKeys:["right","down","pagedown","space","enter"],onKeyEvent:function(e,n){return g(n)}}),o.a.createElement(y.a,{handleKeys:["left","up","pageup"],onKeyEvent:function(e,n){return p(n)}}),a?o.a.createElement(U,{caption:"Loading..."}):i.length?e.index>=i.length?o.a.createElement(U,{caption:"The end"}):o.a.createElement("div",null,o.a.createElement("img",{src:m(i[e.index]),className:"center",alt:i[e.index]}),e.index+1<i.length&&o.a.createElement("img",{width:"0",height:"0",src:m(i[e.index+1]),alt:""}),e.index>0&&o.a.createElement("img",{width:"0",height:"0",src:m(i[e.index-1]),alt:""})):(e.onNoPhotos&&e.onNoPhotos(),o.a.createElement(U,{caption:"No photos"})));function m(e){var n=function(){return{width:e(l.width),height:e(l.height)};function e(e){return Math.max(100,50*Math.floor(e/50))}}();return"/image/"+F(JSON.stringify({key:e,edits:{resize:{width:n.width,height:n.height,fit:"contain"}}}))}function p(n){n&&n.preventDefault(),e.index>0&&e.history.push(e.history.location.pathname+"?"+(e.index-1))}function g(n){n&&n.preventDefault(),e.index>=i.length||(e.index+1>=i.length&&c&&L(t),e.history.push(e.history.location.pathname+"?"+(e.index+1)))}},R=t(396),_=t(161),z=t.n(_),B=t(397),J=function(e){return o.a.createElement(B.a,{onClick:e.onClick,className:e.className},o.a.createElement(B.a.Body,null,o.a.createElement(B.a.Text,null,e.folderName)))},K=function(e){return o.a.createElement(B.a,{bg:"secondary",onClick:e.onClick},o.a.createElement(B.a.Img,{src:"/image/"+F(JSON.stringify({key:e.url,edits:{resize:{width:240,height:240}}})),variant:"top"}))},W=function(e){var n=C();Object(a.useEffect)((function(){P(n,e.path)}));var t=Object(d.a)(n,1)[0],r=t.subfolders,i=t.isLoading,c=t.images,s=t.hasMoreImages,u=r;return"/"!==e.path&&(u=[H].concat(r)),i&&!s?o.a.createElement(U,{caption:"Loading..."}):o.a.createElement(z.a,{className:"folder-browser",initialLoad:!1,loadMore:function(){return L(n)},hasMore:s,loader:o.a.createElement(U,{key:0,caption:"Loading..."})},o.a.createElement(R.a,{className:"folders"},u.map((function(n){return o.a.createElement(J,{className:n===H?"level-up":void 0,key:n,folderName:n,onClick:function(){return e&&e.onChangeFolderIntent&&e.onChangeFolderIntent(n)}})}))),o.a.createElement(R.a,{className:"images"},c.map((function(n,t){return o.a.createElement(K,{key:n,url:n,onClick:function(){return e.onSwitchToViewingIntent(t)}})}))))},H="\u21d6";h.a.configure(window.AWS_EXPORTS);var G=function(e){var n=Object(a.useState)(!1),t=Object(d.a)(n,2),r=t[0],i=t[1],c=C(),s=Object(d.a)(c,1)[0].error;return s?o.a.createElement(U,{caption:s}):o.a.createElement(m.Authenticator,{hide:[m.Greetings,m.ConfirmSignIn,m.SignUp,m.ConfirmSignUp,m.TOTPSetup].concat(window.AUTH_UI_OPTIONS&&window.AUTH_UI_OPTIONS.hideForgotPassword?[m.ForgotPassword]:[]),onStateChange:function(){var e=Object(l.a)(u.a.mark((function e(n){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("signedIn"!==n){e.next=4;break}return e.next=3,b();case 3:i(!0);case 4:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()},r&&o.a.createElement(p.MenuProvider,{id:"menu"},o.a.createElement(g.a,null,o.a.createElement(w.a,{render:function(e){var n=e.history,t=n.location.pathname;return"?browse"===n.location.search?o.a.createElement(W,{path:decodeURIComponent(t),onChangeFolderIntent:function(e){var r;e===H?""===(r=t.slice(0,t.lastIndexOf("/")))&&(r="/"):("/"!==(r=t)&&(r+="/"),r+=encodeURIComponent(e)),n.push(r+"?browse")},onSwitchToViewingIntent:function(e){return n.push(n.location.pathname+"?"+e)}}):o.a.createElement(D,{history:n,path:decodeURIComponent(t),index:n.location.search?parseInt(n.location.search.slice(1)):0,onNoPhotos:function(){return n.push(n.location.pathname+"?browse")}})}}),o.a.createElement(w.a,{render:function(e){var n=e.history;return o.a.createElement(p.Menu,{id:"menu"},"?browse"!==n.location.search&&o.a.createElement(p.Item,{onClick:function(){return n.push(n.location.pathname+"?browse")}},"Browse"),"?browse"!==n.location.search&&o.a.createElement(p.Separator,null),o.a.createElement(p.Item,{onClick:function(){return h.a.Auth.signOut(),void i(!1)}},"Sign out"))}}))));function b(){return E.apply(this,arguments)}function E(){return(E=Object(l.a)(u.a.mark((function n(){var t,r;return u.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,f.API.graphql(Object(f.graphqlOperation)(v));case 2:t=n.sent,(r=t.data).getSignedCookies&&r.getSignedCookies.forEach((function(n){n&&e.cookies.set(n.name,n.value,{path:"/image",secure:!0})}));case 5:case"end":return n.stop()}}),n)})))).apply(this,arguments)}},V=Object(b.a)((function(e){return o.a.createElement(N,null,o.a.createElement(G,e))}));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(o.a.createElement(V,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},62:function(e,n){}},[[168,1,2]]]);
//# sourceMappingURL=main.5e413f59.chunk.js.map